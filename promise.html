<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>promise</title>
  </head>
  <body>
    <script>
      //í”„ë¡œë¯¸ìŠ¤ëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ object ì•ˆì— ë‚´ì¥ë˜ì–´ ìˆëŠ” í•¨ìˆ˜
      //ë¹„ë™ê¸°ë¥¼ ìˆ˜í–‰í•  ë•Œ ì½œë°±í•¨ìˆ˜ ëŒ€ì‹ ì— ì‚¬ìš©í•¨
      //State: pending -> fulfilled or rejected
      //Producer vs Consumere

      //1. Producer
      const promise = new Promise((resolve, reject) => {
        //ì¡°ê¸ˆ ë¬´ê±°ìš´ ì¼ë“¤ì„ í•¨
        //íŒŒì¼ì—ì„œ ë°ì´í„°ë¥¼ ì½ì–´ì˜´ -> ë¹„ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬í•  ê²ƒ
        //network, read files
        //ìƒˆë¡œìš´ í”„ë¡œë¯¸ìŠ¤ê°€ ë§Œë“¤ì–´ì§ˆ ë•ŒëŠ” ìš°ë¦¬ê°€ ì „ë‹¬í•œ
        //executorë¼ëŠ” ì½œë°± í•¨ìˆ˜ê°€ ë°”ë¡œ ì‹¤í–‰ë¨!!
        console.log("doing something...");
        setTimeout(() => {
          resolve("young");
          //rejectë¥¼ ì´ìš©í•´ error ë˜ì§€ê¸°
          //reject(new Error("no network"));
        }, 2000);
      });

      //2. promise ì‚¬ìš©í•˜ê¸° -> Consumers(then, catch, finally)
      promise
        .then((value) => {
          //value - resolveì—ì„œ ì „ë‹¬ëœ ê°’ì´ ë“¤ì–´ì˜´
          console.log(value);
        })
        .catch((error) => {
          console.log(error);
        })
        .finally(() => {
          console.log("finally");
        });

      //3. promsie ì—°ê²°í•˜ê¸° - chaining
      //ë‹¤ë¥¸ ë¹„ë™ê¸°ì ì¸ ì• ë“¤ì„ ë¬¶ì–´ì„œ ì²˜ë¦¬ ê°€ëŠ¥í•¨
      const fetchNumber = new Promise((resolve, reject) => {
        setTimeout(() => resolve(1), 1000);
      });
      //ì—¬ê¸°ì„œ 1ì´ ì „ë‹¬ë¨!
      fetchNumber
        .then((num) => num * 2) //2
        .then((num) => num * 3) //6
        .then((num) => {
          //6 - 1 = 5
          return new Promise((resolve, reject) => {
            setTimeout(() => resolve(num - 1), 1000);
          });
        })
        .then((num) => console.log(num));

      //4. ì˜¤ë¥˜ í•¸ë“¤ë§ í•˜ê¸°
      //error handing
      const getHen = () =>
        new Promise((resolve, reject) => {
          setTimeout(() => resolve(`ğŸ‘¨â€ğŸ³`), 1000);
        });
      const getEgg = (hen) =>
        new Promise((resolve, reject) => {
          setTimeout(() => reject(new Error(`${hen} => ğŸ¥š`)), 1000);
        });

      const cook = (egg) =>
        new Promise((resolve, reject) => {
          setTimeout(() => resolve(`${egg} => ğŸ³`), 1000);
        });

      //getHen í•¨ìˆ˜ í˜¸ì¶œí•´ì„œ ì¼ë‹¨ ë°ì´í„°ë¥¼ ë°›ì•„ì˜´!
      //hen -> ë‹­
      //egg -> ê³„ë€
      //meal -> ê³„ë€í›„ë¼ì´
      getHen()
        .then((hen) => getEgg(hen))
        .catch((error) => {
          return `ğŸ`;
        })
        .then(cook)
        .then((meal) => console.log(meal))
        .catch((error) => {
          console.log(error);
        });
      //then(getEgg)
      //í•œê°€ì§€ë§Œ ë°›ì•„ì„œ ì „ë‹¬í•˜ëŠ”ê²½ìš°ì—ëŠ” ìƒëµì´ ê°€ëŠ¥í•¨

      //   getHen().then(getEgg).then(cook).then(console.log).catch(console.log);
    </script>
  </body>
</html>

<!-- 

ì•½ì†
-ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì œê³µ,
ë¹„ë™ê¸°ë¥¼ ê°„í¸í•˜ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡, 
ë„ì™€ì£¼ëŠ” object(ì˜¤ë¸Œì íŠ¸)


1. state(ìƒíƒœ)
-ê¸°ëŠ¥ ìˆ˜í–‰ì´ ë˜ëŠ”ì¤‘ì¸ì§€?

2. ì›í•˜ëŠ” ë°ì´í„°ë¥¼ ì œê³µí•˜ëŠ” ì‚¬ëŒ/ ì œê³µëœ ë°ì´í„°ë¥¼ ì“°ëŠ” ì‚¬ëŒ
ì œê³µì / ì‚¬ìš©ì

Promiseë„ ìƒì„±ìë‹¤
-ë‘ ê°œì˜ ì½œë°±í•¨ìˆ˜ë¥¼ ë°›ìŒ
resolveì™€ reject


reject
-ì¤‘ê°„ì— ë¬¸ì œê°€ ìƒê¸°ë©´ í˜¸ì¶œ


promiseë¥¼ ë§Œë“œëŠ” ìˆœê°„
ì „ë‹¬í•œ í•¨ìˆ˜ê°€ ë°”ë¡œ ì‹¤í–‰
exeu!!
ë„¤íŠ¸ì›Œí¬ í†µì‹ ì„ í•  ë•Œ promise ì‚¬ìš©

ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì„ ì‚¬ìš©ìë§Œ í–ˆì„ ê²½ìš°ì—ëŠ”
ì–´ë–»ê²Œ ì²˜ë¦¬í• ê¹Œ?
->ì´ ì ì„ ìœ ì˜í•´ì„œ ê³µë¶€í•˜ê¸°
->ë¶ˆí•„ìš”í•œ ë„¤íŠ¸ì›Œí¬ í†µì‹ 


ì—ëŸ¬ í•¸ë“¤ë§í•˜ê¸°?
-> catchì˜ ì½œë°±í•¨ìˆ˜ ì´ìš©í•¨ 

promiseì˜ thenì„ í˜¸ì¶œí•˜ê²Œ ë˜ë©´
promiseë¥¼ ë°˜í™˜í•˜ê¸° ë•Œë¬¸ì—,
catchë¥¼ ë‹¤ì‹œ í˜¸ì¶œí•  ìˆ˜ ìˆìŒ
-> ì²´ì´ë‹

array
-returnëœ arrayë¥¼ ì´ìš©í•˜ëŠ” ê²ƒì²˜ëŸ¼
promiseì—ì„œ thenì„ ì´ìš©í•˜ë©´
promise ë°˜í™˜!

ë¹„ë™ê¸°ì ìœ¼ë¡œ ìˆ˜í–‰í•˜ê³  ì‹¶ì€ ì½”ë“œë¥¼
promise ì•ˆì—ë‹¤ê°€ ì§‘ì–´ë„£ê¸°
-rejectë¥¼ ê³ ë ¤í•´, error ì²˜ë¦¬ê¹Œì§€ í•´ì¤„ê²ƒ

finally
-ë¬´ì¡°ê±´ í•œ ë²ˆì€ ì‹¤í–‰ë¨!!
-ì—ëŸ¬ê°€ ì•„ë‹ˆë”ë¼ë„!


thenì€ ê°’ ë˜ëŠ” promiseë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆìŒ!
ìƒˆë¡œìš´ promiseì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤ëŠ” ì´ì•¼ê¸°

ì•”íƒ‰ìœ¼ë¡œ ë‹¬ê±€ì„ ì–»ê³  -> ì—ê·¸ í”„ë¼ì´ê¹Œì§€ ë§Œë“¦

ë§Œì•½ì— 
ì¤‘ê°„ì— ì—ëŸ¬ê°€ ë°œìƒí•´ì„œ rejectë˜ë©´?
-> ì—ëŸ¬ í•¸ë“¤ë§ì„ í•´ì¤˜ì•¼í•¨

ë‹¬ê±€ì„ ë°›ì•„ì˜¬ ë•Œ ë¬¸ì œê°€ ìƒê¸´ë‹¤ë©´,
ë‹¤ë¥¸ ì¬ë£Œë¡œ ëŒ€ì²´í•˜ê³  ì‹¶ìŒ


 -->
